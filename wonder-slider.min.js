/* 
  Name: Wonder Slider
  Version: 0.6
  Description: A full screen slider with automatic image positioning.
  Tested: FF 16(Windows), Chrome 22(Windows), Opera 12(Windows), Internet Explorer 9(Windows)
  Features: Images, Youtube and Vimeo videos, controls and progress bar. Can change images on the fly.
  Future: Add thumbnails, slide and random effects
  Uses: Weer for absolute image positioning see below the WonderSlider
  License: GNU/GPL
*/
(function(){jQuery.wonderslider=function(a,b){return jQuery.wonderSlider(a,b)},jQuery.WonderSlider=function(a,b){return jQuery.wonderSlider(a,b)},jQuery.wonderSlider=function(a,b){var c=jQuery.extend({delay:5e3,speed:400,preload:!0,autoplay:!0,buildHTML:!0,forceStopMedia:!0,progressBar:!0,progressBarColor:"#000",color:"#000",onBeforeChange:function(){},onAfterChange:function(){},onInit:function(){},onNextClick:function(){},onPrevClick:function(){},onPlayPauseClick:function(){},firstVideoAutoplay:!0,stopAudioTags:!0,youtube:"http://www.youtube-nocookie.com/embed/%v?rel=0&amp;autoplay=%a&amp;controls=0&amp;modestbranding=1&amp;wmode=opaque",vimeo:"http://player.vimeo.com/video/%v/?autoplay=%a",animation:"fade"},b),d={interval:!1,current:!1,progressBar:"",items:"",errors:!0};d.forceStopMedia=function(){c.forceStopMedia==1&&(jQuery("iframe").each(function(){var a=jQuery(this).attr("src");(/youtube/.test(a)||/vimeo/.test(a))&&jQuery(this).attr("src",a)}),jQuery("audio").each(function(){jQuery(this).get(0).pause()}))},d.getVideoID=function(a,b){return b.toLowerCase()=="youtube"?a.match(/.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/i)[1]:a.match(/\d+/)[0]},d.parseInput=function(a){var b=Array();if(typeof a=="object")for(i in a)if(typeof a[i]=="string")/https?:\/\/(www\.)?youtube/gi.test(a[i])?b.push({type:"youtube",id:d.getVideoID(a[i],"youtube")}):/https?\:\/\/vimeo\.com/gi.test(a[i])?b.push({type:"vimeo",id:d.getVideoID(a[i],"vimeo")}):b.push({type:"image",src:a[i],caption:!1});else if(typeof a[i]=="object")if(a[i].video===void 0||a[i].video.toLowerCase()==="vimeo"&&a[i].video.toLowerCase()==="youtube"){var e={type:"image"};a[i].src!==void 0&&(e.src=a[i].src,e.caption=a[i].caption!==void 0?a[i].caption:!1,b.push(e))}else{var c={};c.type=a[i].video.toLowerCase(),c.caption=a[i].caption,a[i].autoplay==void 0&&(a[i].autoplay=!1),c.autoplay=a[i].autoplay?!1:!0,a[i].id!==void 0?(c.id=a[i].id,b.push(c)):a[i].url!==void 0&&(c.url=a[i].url,b.push(c))}return b},d.run=function(){var b=d.parseInput(a);d.buildHTML(b),d.bindEvents(),d.progressBar=jQuery("#wonder-slider .progress-bar"),d.items=jQuery("#wonder-slider ul li"),d.current=jQuery("#wonder-slider .slides li.slide-0");try{c.onInit.call(d)}catch(e){}jQuery("#wonder-slider").css("backgroundImage","none"),d.current.children("img").length>0?d.current.children("img").attr("src",d.current.children("img")[0].src+"?"+(new Date).getTime()).load(function(){jQuery(this).parent().addClass("active").end().fadeIn(100),c.autoplay&&d.startAnimation()}):c.autoplay&&d.startAnimation()},d.isPlaying=function(){return jQuery("#wonder-slider .controls .play-pause").hasClass("playing")},d.bindEvents=function(){jQuery("#wonder-slider .controls .next").bind("click",function(){try{c.onNextClick.call()}catch(a){}if(d.isPlaying())d.switchSlide("next");else{var b=d.current.next().length>0?d.current.next():d.items.first();d.animate(b)}}),jQuery("#wonder-slider .controls .prev").bind("click",function(){try{c.onNextClick.call()}catch(a){}if(d.isPlaying())d.switchSlide("prev");else{var b=d.current.prev().length>0?d.current.prev():d.items.last();d.animate(b)}}),jQuery("#wonder-slider .controls .play-pause").bind("click",function(){try{c.onPlayPauseClick.call()}catch(a){}jQuery(this).hasClass("paused")?(d.startAnimation(),jQuery(this).removeClass("paused").addClass("playing")):(window.clearInterval(d.interval),d.progressBar.stop().css("width","0"),jQuery(this).removeClass("playing").addClass("paused"))})},d.animateProgressBar=function(){c.progressBar&&d.progressBar.css("width","0").stop().animate({width:"100%"},c.delay+10)},d.startAnimation=function(){d.animateProgressBar(),d.interval=window.setInterval(function(){d.switchSlide()},c.delay)},d.animate=function(a){c.animation=="fade"&&(jQuery("#wonder-slider div.caption").hide(),d.current.stop().animate({opacity:0},c.speed,function(){jQuery(this).removeClass("active")}),a.stop().animate({opacity:1},c.speed).addClass("active"),d.current=a,a.children("div.caption").fadeIn(200),a.hasClass("youtube")&&d.videoFrame(d.current,"youtube"),a.hasClass("vimeo")&&d.videoFrame(d.current,"vimeo"))},d.videoFrame=function(){},d.switchSlide=function(a){d.forceStopMedia();try{c.onBeforeChange.call(d)}catch(b){}if(d.animateProgressBar(),a===void 0){var e=d.current.next().length>0?d.current.next():d.items.first();d.animate(e)}else if(a=="next"){window.clearInterval(d.interval),d.interval=window.setInterval(function(){d.switchSlide("next")},c.delay);var e=d.current.next().length>0?d.current.next():d.items.first();d.animate(e)}else if(a=="prev"){window.clearInterval(d.interval),d.interval=window.setInterval(function(){d.switchSlide("next")},c.delay);var f=d.current.prev().length>0?d.current.prev():d.items.last();d.animate(f)}try{c.onAfterChange.call(d)}catch(b){}},d.buildHTML=function(a){jQuery("#wonder-slider").remove();var b="<div id='wonder-slider'><ul class='slides'>";for(i in a){var e=a[i],f=i%2==0?"odd":"even",g=i==0?" active ":"";if(b+="<li class='"+e.type+g+" slide-"+i+" "+f+"'>",e.type=="youtube"){if(i==0&&c.firstVideoAutoplay==1){d.stopAudioTags();var h=c.youtube.replace("%v",e.id).replace("%a",1)}else var h=c.youtube.replace("%v",e.id).replace("%a",0);e.caption&&(b+="<div class='caption'>"+e.caption+"</div>"),b+="<iframe data-id='"+e.id+"' data-from='youtube' data-autoplay='"+e.autoplay+"' frameborder='0' src='"+h+"'></iframe>"}else if(e.type=="vimeo"){if(e.caption&&(b+="<div class='caption'>"+e.caption+"</div>"),i==0&&c.firstVideoAutoplay==1){var h=c.vimeo.replace("%v",e.id).replace("%a",!0);d.stopAudioTags()}else var h=c.vimeo.replace("%v",e.id).replace("%a",!1);b+="<iframe data-id='"+e.id+"' data-from='vimeo' data-autoplay='"+e.autoplay+"' frameborder='0' src='"+h+"'></iframe>"}else c.preload&&d.preloadImage(e.src),e.caption&&(b+="<div class='caption'>"+e.caption+"</div>"),b+="<img src='"+e.src+"' />";b+="</li>"}b+="</ul>",a.length>1&&(b+="<div class='progress-bar'></div><div class='controls'><div class='prev'><span></span></div><div class='play-pause playing'><span></span></div><div class='next'><span></span></div></div>"),jQuery("body").append(b),d.styling();try{jQuery("#wonder-slider ul li img").weer()}catch(j){}},d.styling=function(){jQuery("#wonder-slider .controls div").css({"background-color":c.color,opacity:"0.6"}).hover(function(){jQuery(this).css("opacity",1)},function(){jQuery(this).css("opacity",.6)}),jQuery("#wonder-slider .progress-bar").css({"background-color":c.progressBarColor})},d.stopAudioTags=function(){jQuery("audio").each(function(){this.pause()})},d.preloadImage=function(a){try{var b=new Image;b.src=a}catch(c){d.errors&&console.warn(c)}},d.run()}})(jQuery),function(a){a.extend(a.fn,{weer:function(){var a={init:function(b){jQuery(b).hide();var c=a.getDimensions(b);a.getCenter(b,c.width,c.height),jQuery(b).fadeIn(350),jQuery(window).resize(function(){a.getCenter(b,c.width,c.height)}),jQuery(b).fadeIn(100)},getDimensions:function(a){var b=Array();return a!==void 0?(b.width=a.naturalWidth,b.height=a.naturalHeight):(b.width=window.innerWidth,b.height=window.innerHeight),b},getCenter:function(b,c,d){$this=jQuery(b);var e=a.getDimensions(),f=a.getReverse(c,d,e.width,e.height),g=f.height>e.height?-((f.height-e.height)/2):0,h=f.width>e.width?-((f.width-e.width)/2):0;jQuery($this).css({top:g+"px",left:h+"px",width:f.width+"px",height:f.height+"px",position:"fixed"})},getReverse:function(a,b,c,d){var e=Array();return c>d?(e.width=c,e.height=c*b/a,d>e.height&&(e.height=d,e.width=a*d/b),e):(e.height=d,e.width=a*d/b,c>e.width&&(e.width=c,e.height=c*b/a),e)}};return jQuery(this).each(function(){jQuery(this).load(function(){a.init(this)})})}})}(jQuery)